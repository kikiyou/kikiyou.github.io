<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="越努力越幸运">
<meta property="og:type" content="website">
<meta property="og:title" content="Monkey">
<meta property="og:url" content="http://www.rhel.cc/page/5/index.html">
<meta property="og:site_name" content="Monkey">
<meta property="og:description" content="越努力越幸运">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Monkey">
<meta name="twitter:description" content="越努力越幸运">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.rhel.cc/page/5/"/>





  <title>Monkey</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-69625009-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?1d19ec01ee75454338de4be42f062626";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>











  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Monkey</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Think! And Think Again</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'qXreyHC_EX5zr5PLMxgp','2.0.0');
</script>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/fonsview/北向网管告警梳理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/fonsview/北向网管告警梳理/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T13:36:42+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/fonsview/北向网管告警梳理/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/fonsview/北向网管告警梳理/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="北向网管告警梳理"><a href="#北向网管告警梳理" class="headerlink" title="北向网管告警梳理"></a>北向网管告警梳理</h1><ol>
<li>告警流水  unix时间戳</li>
<li>告警时间 2017-03-02</li>
<li>网元名称 主机名 </li>
<li>网元类型 </li>
<li>网元IP 告警主机ip</li>
<li>网元ID 不填</li>
<li>告警码  时间id -&gt; {EVENT.ID}</li>
<li>告警分类 分类 1-5</li>
<li>告警级别 级别 1-4 5是清除   –&gt; {TRIGGER.SEVERITY}</li>
<li>告警定位 </li>
<li>告警原因</li>
<li>告警附加 映射表中字段(“epgconnerror”)</li>
</ol>
<hr>
<p>能自由发挥的 三个参数</p>
<ol>
<li>产生告警的网元类型 </li>
<li>告警定位信息 </li>
<li>告警原因</li>
</ol>
<hr>
<ol>
<li>产生告警的网元类型  unknow</li>
<li>告警定位信息 ：{ITEM.NAME} + {ITEM.VALUE}</li>
<li>告警原因： {TRIGGER.NAME}</li>
</ol>
<hr>
<p>在告警解释里面，附加信息，</p>
<ol>
<li>epg_error  epg错误</li>
<li>ss_error ss错误</li>
<li>unknow  未标识错误</li>
</ol>
<hr>
<ol>
<li>先判断，告警解释{TRIGGER.DESCRIPTION}中是否 有$$.开始的字段，如果有就把其中json解析替换，</li>
<li>如果没有就是unknow，原生发出</li>
</ol>
<p>网元类型  就是unknow</p>
<ol>
<li><p>告警解释中内容(全)：<br>$$.{“告警流水”:”1212121”,”告警时间”:”2017-03-02”,”网元名称”:”CZ-WFLT-F4-IPTV-Server-EPG01”,”网元类型”:”EPG”, “网元IP”:”1.1.1.1”,”网元ID”:””,”告警码”:”12121”,”告警分类”:”1”,”告警级别”:”1”,”告警定位”:”Free disk space is less than 20% on volume /“ “10%”,”告警原因”:”Free disk space on / (percentage)”,”告警附加”:”11111”}</p>
</li>
<li><p>一般<br>$$.{“网元类型”:”EPG”,”告警附加”:”epgconnerror”}</p>
</li>
</ol>
<p>—–发出的告警内容是 原生<br>告警流水： 1212121<br>告警时间： 2017-03-01<br>网元名称: CZ-WFLT-F4-IPTV-Server-EPG01<br>网元类型: unknow<br>网元IP: 1.1.1.1<br>网元ID： 不填<br>告警码: 111<br>告警分类: 1<br>告警级别: 1<br>告警定位: “Free disk space is less than 20% on volume /“ ： “10%”<br>告警原因: Free disk space on / (percentage)<br>告警附加: 未标识错误</p>
<p>——发出告警的内容 自定义<br>告警流水： 1212121<br>告警时间： 2017-03-01<br>网元名称: CZ-WFLT-F4-IPTV-Server-EPG01<br>网元类型: EPG<br>网元IP: 1.1.1.1<br>网元ID： 不填<br>告警码: 111<br>告警分类: 1<br>告警级别: 1<br>告警定位: “Free disk space is less than 20% on volume /“ ： “10%”<br>告警原因: Free disk space on / (percentage)<br>告警附加: EPG连接错误</p>
<h2 id="告警恢复策略"><a href="#告警恢复策略" class="headerlink" title="告警恢复策略"></a>告警恢复策略</h2><ol>
<li>告警级别 是5 </li>
<li>第11 和 12字段 内容一致 （告警和恢复不变）</li>
<li>第10个字段完全可变</li>
</ol>
<p>所以 第11个字段不应该是 {TRIGGER.NAME}  应该是 {ITEM.NAME}</p>
<p>第10个字段是 可以变的，可以在第10个字段里面写 {TRIGGER.NAME} </p>
<hr>
<p>名称:北向网管告警<br>默认接收人:{TRIGGER.DESCRIPTION}<br>默认信息:</p>
<h2 id="“host-name”-”-HOST-NAME-”-”host-ip”-”-HOST-IP-”-”alarm-code”-”-EVENT-ID-”-”alarm-level”-”-TRIGGER-SEVERITY-”-”alarm-status”-”-TRIGGER-STATUS-”-”alarm-extend-info”-”-TRIGGER-NAME-”-”alarm-probablecause”-”-ITEM-NAME-”"><a href="#“host-name”-”-HOST-NAME-”-”host-ip”-”-HOST-IP-”-”alarm-code”-”-EVENT-ID-”-”alarm-level”-”-TRIGGER-SEVERITY-”-”alarm-status”-”-TRIGGER-STATUS-”-”alarm-extend-info”-”-TRIGGER-NAME-”-”alarm-probablecause”-”-ITEM-NAME-”" class="headerlink" title="{“host_name”:”{HOST.NAME}”,”host_ip”:”{HOST.IP}”,”alarm_code”:”{EVENT.ID}”,”alarm_level”:”{TRIGGER.SEVERITY}”,”alarm_status”:”{TRIGGER.STATUS}”,”alarm_extend_info”:”{TRIGGER.NAME}”,”alarm_probablecause”:”{ITEM.NAME}”}"></a>{“host_name”:”{HOST.NAME}”,”host_ip”:”{HOST.IP}”,”alarm_code”:”{EVENT.ID}”,”alarm_level”:”{TRIGGER.SEVERITY}”,”alarm_status”:”{TRIGGER.STATUS}”,”alarm_extend_info”:”{TRIGGER.NAME}”,”alarm_probablecause”:”{ITEM.NAME}”}</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/fonsview/各网元启动方式与检测办法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/fonsview/各网元启动方式与检测办法/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T13:35:57+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/fonsview/各网元启动方式与检测办法/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/fonsview/各网元启动方式与检测办法/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="各网元-启动方式和检测办法"><a href="#各网元-启动方式和检测办法" class="headerlink" title="各网元 启动方式和检测办法"></a>各网元 启动方式和检测办法</h1><p>ott 地址: 172.16.199.119<br>包含模块:</p>
<p>cdn 地址: 172.16.199.120<br>包含模块: CMM SS</p>
<h2 id="CMM"><a href="#CMM" class="headerlink" title="CMM"></a>CMM</h2><ul>
<li><p>启动方式:<br>/opt/fonsview/NE/cmm/bin/start.sh</p>
</li>
<li><p>检测办法<br>访问:<br><a href="http://172.16.199.120:8190/ContentDeployReq" target="_blank" rel="external">http://172.16.199.120:8190/ContentDeployReq</a><br>返回: 200</p>
</li>
</ul>
<h2 id="SS"><a href="#SS" class="headerlink" title="SS"></a>SS</h2><ul>
<li><p>启动方式:<br>/opt/fonsview/NE/ss/bin/start.sh</p>
</li>
<li><p>检测办法<br>地址:</p>
</li>
</ul>
<ul>
<li>RR_IPTV  rtsp://172.16.199.120:554</li>
<li>RR_HPD   <a href="http://172.16.199.120:8106" target="_blank" rel="external">http://172.16.199.120:8106</a></li>
<li>RR_HLS   <a href="http://172.16.199.120:8112" target="_blank" rel="external">http://172.16.199.120:8112</a></li>
</ul>
<p>可以查看这些端口 是否处于 侦听状态</p>
<h2 id="oss"><a href="#oss" class="headerlink" title="oss"></a>oss</h2><p>地址:<br><a href="http://172.16.199.120:8081/oss/login.seam?cid=1" target="_blank" rel="external">http://172.16.199.120:8081/oss/login.seam?cid=1</a><br>返回:200</p>
<p>管理员账户:001<br>密码:111111</p>
<p>在 aaa 里面 看 userprofile 表中 是否有创建账户</p>
<h2 id="rabbitmp"><a href="#rabbitmp" class="headerlink" title="rabbitmp"></a>rabbitmp</h2><p><a href="http://server-name:15672" target="_blank" rel="external">http://server-name:15672</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/fonsview/堡垒主机连接方式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/fonsview/堡垒主机连接方式/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T13:35:57+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/fonsview/堡垒主机连接方式/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/fonsview/堡垒主机连接方式/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#老主机 centos5<br>ssh  fonsview@10.192.102.xx -o ProxyCommand=’ssh hetxng@xx.68.211.4  nc %h 50000’ “ls /tmp”</p>
<p>#新主机 centos6<br>ssh  fonsview@10.192.102.xx -o ProxyCommand=’ssh -W %h:50000 hetxng@xx.68.211.4 ‘ “ls /tmp”</p>
<p>config</p>
<p>Host bastion<br>  Hostname 192.168.100.102<br>  IdentityFile ~/.ssh/bastion_rsa<br>  User vagrant</p>
<p>Host remote*<br>  IdentityFile ~/.ssh/remote_rsa<br>  ProxyCommand ssh bastion -W %h:%p</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/fonsview/机顶盒播放数据流程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/fonsview/机顶盒播放数据流程/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T13:35:57+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/fonsview/机顶盒播放数据流程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/fonsview/机顶盒播放数据流程/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="机顶盒播放数据流程"><a href="#机顶盒播放数据流程" class="headerlink" title="机顶盒播放数据流程"></a>机顶盒播放数据流程</h1><p>机顶盒地址: 172.16.12.42<br>epg地址: 172.16.199.120<br>aaa地址: 172.16.199.120<br>ss地址: 172.16.199.120</p>
<h2 id="1-盒子请求epg页面"><a href="#1-盒子请求epg页面" class="headerlink" title="1.盒子请求epg页面"></a>1.盒子请求epg页面</h2><p>盒子请求:<br>GET /epg/index.html HTTP/1.1<br>Host: 172.16.199.120:6600</p>
<p>epg 返回: OK</p>
<h2 id="2-盒子请求aaa认证-认证是否为合法的盒子"><a href="#2-盒子请求aaa认证-认证是否为合法的盒子" class="headerlink" title="2.盒子请求aaa认证,认证是否为合法的盒子"></a>2.盒子请求aaa认证,认证是否为合法的盒子</h2><p>盒子请求:<br>POST /aaa/services/rest/V2/AAA/User/Login HTTP/1.1  (application/json)<br>{<br>    userToken: 979D7C1B0586C8D4E53311BE0E7DC880<br>    terminalType: 2<br>    deviceId: g18ref<br>    timestamp: 89698982<br>    timezone: Asia/Shanghai<br>    random: a0d87557-fd39-4d0f-9c70-7a1f27f17151<br>    isTestUser: 0<br>    sp:<br>    hmac: ZXpcIcdiKCDAh8zacPXQueHqghfBpna3zL7X7wIR+ko=<br>    userId: U00000013<br>}</p>
<p>aaa认证成功返回:<br>{<br>    “resultCode”: “0”,<br>    “description”: “ok”,<br>    “userId”: “U00000013”,<br>    “userToken”: “45F051331AFE21F8CB3B0351C95C4AE4”,<br>    “expiration”: “43200000”,<br>    “channelList”: [],<br>    “group”: “EPG_default,User_99”,<br>    “sp”: “”,<br>    “isTestUser”: 0,<br>    “entryList”: [<br>        {<br>            “type”: “epg”,<br>            “url”: “<a href="http://172.16.199.120:6600/epg/rest/SPM" target="_blank" rel="external">http://172.16.199.120:6600/epg/rest/SPM</a>“<br>        }<br>    ]<br>}</p>
<h2 id="3-盒子获取EPG资源"><a href="#3-盒子获取EPG资源" class="headerlink" title="3.盒子获取EPG资源"></a>3.盒子获取EPG资源</h2><p>盒子请求:<br>GET /epg/rest/SPM/V2/Template/Info?group=EPG_default%2CUser_99&amp;epgIdentifier=com.hunantv.operator.hnyd&amp;epgVersion=50034 HTTP/1.1<br>{<br>    userToken: 45F051331AFE21F8CB3B0351C95C4AE4<br>    terminalType: 2<br>    deviceId: g18ref<br>    timestamp: 89699302<br>    timezone: Asia/Shanghai<br>    random: 5901aa4a-caa0-48dd-b026-050411119915<br>    isTestUser: 0<br>    sp:<br>    hmac: y7MdIe50a9qLAMyNTwqGRt9Hp5CGmhGacBdHWjlyTYw=<br>    userId: U00000013<br>}</p>
<p>EPG返回:<br>{<br>    “resultCode”: 0,<br>    “description”: “Success”,<br>    “templateVersion”: 9,<br>    “templateId”: 1<br>}</p>
<h2 id="4-盒子获取EPG-模板配置"><a href="#4-盒子获取EPG-模板配置" class="headerlink" title="4.盒子获取EPG 模板配置"></a>4.盒子获取EPG 模板配置</h2><p>GET /epg/rest/SPM/V2/Template/1/Configuration HTTP/1.1<br>{<br>    userToken: 45F051331AFE21F8CB3B0351C95C4AE4<br>    …..<br>}</p>
<p>EPG返回:<br>{<br>    “configuration”: {<br>        “toolbar”: {<br>            ….<br>        }<br>    }<br>}</p>
<h2 id="5-盒子获取-EPG各项内容"><a href="#5-盒子获取-EPG各项内容" class="headerlink" title="5.盒子获取 EPG各项内容"></a>5.盒子获取 EPG各项内容</h2><p>GET /epg/rest/SPM/V2/Media/Label?language=zh_CN&amp;type=1 HTTP/1.1<br>GET /epg/rest/SPM/V2/EPG/com.hunantv.operator.hnyd/Version/50034/Configuration?group=EPG_default%2CUser_99&amp;version=0 HTTP/1.1<br>GET /epg/rest/SPM/V2/App/Check/com.hunantv.operator/Version/50034?manufacturer=FONSVIEW&amp;group=EPG_default%2CUser_99&amp;macAddress=00%3A11%3A6D%3A18%3A83%3AA8&amp;identity=00116D1883A8&amp;epgIdentifier=com.hunantv.operator.hnyd&amp;model=F720&amp;stbId=12345678900 HTTP/1.1<br>GET /epg/rest/SPM/V3/Media/MediaType/2/Content/00000003000000001234000000000017?kid=0&amp;index=0&amp;language=zh_CN HTTP/1.1</p>
<h2 id="6-盒子请求EPG的认证-查看是否可以播放这个资源"><a href="#6-盒子请求EPG的认证-查看是否可以播放这个资源" class="headerlink" title="6.盒子请求EPG的认证,查看是否可以播放这个资源"></a>6.盒子请求EPG的认证,查看是否可以播放这个资源</h2><p>POST /epg/rest/SPM/V3/AAA/Content/Single/Authentication HTTP/1.1<br>{<br>    “contentId”: “00000003000000001234000000000017”,<br>    “index”: “0”,<br>    “mediaType”: “2”<br>}</p>
<p>EPG认证成功返回 播放地址:<br>{<br>    “resultCode”: 0,<br>    “contentId”: “00000003000000001234000000000017”,<br>    “description”: “Success”,<br>    “playUrl”: [<br>        {<br>            “subtitles”: null,<br>            “contentId”: “00000003000000001234000000000019”,<br>            “length”: “00042100”,<br>            “format”: 1,<br>            “pId”: “00000003000000001234000000000018”,<br>            “episode”: 1,<br>            “is3D”: 0,<br>            “bitrate”: null,<br>            “playUrl”: “<a href="http://172.16.199.120:8112/fonsview_hls/00000003000000001234000000000019" target="_blank" rel="external">http://172.16.199.120:8112/fonsview_hls/00000003000000001234000000000019</a>“<br>        }<br>    ]<br>}</p>
<h2 id="7-盒子-请求EPG"><a href="#7-盒子-请求EPG" class="headerlink" title="7. 盒子 请求EPG"></a>7. 盒子 请求EPG</h2><p>盒子:<br>GET /epg/rest/SPM/V2/AD/Scene/HNYD_LOADING?group=EPG_default%2CUser_99&amp;language=zh_CN HTTP/1.1</p>
<p>EPG返回:<br>{<br>    “ads”: [],<br>    “adrule”: 0,<br>    “totalTime”: 0,<br>    “resultCode”: 1,<br>    “description”: “No advertisement”<br>}</p>
<p>盒子:<br>GET /epg/rest/SPM/V2/Recommend/MediaType/2/Content/00000003000000001234000000000017?categoryId=null&amp;programType=1000&amp;begin=0&amp;pageSize=12&amp;language=zh_CN HTTP/1.1</p>
<p>EPG返回:<br>{<br>    “resultCode”: 0,<br>    “description”: “Success”,<br>    “metadataList”: []<br>}</p>
<h2 id="8-盒子向ss请求资源-流媒体播放地址"><a href="#8-盒子向ss请求资源-流媒体播放地址" class="headerlink" title="8.盒子向ss请求资源 流媒体播放地址"></a>8.盒子向ss请求资源 流媒体播放地址</h2><p>盒子:<br>GET /fonsview_hls/00000003000000001234000000000019?stbId=12345678900&amp;userID=U00000013&amp;userToken=&amp;usergroup= HTTP/1.1<br>Host: 172.16.199.120:8112</p>
<p>SS返回 location 让盒子重定向:<br>Location: <a href="http://172.16.199.120:8114/fonsview_hls/00000003000000001234000000000019?stbId=12345678900&amp;userID=U00000013&amp;userToken=&amp;usergroup=&amp;FvSeid=5599584b10b683d0&amp;Fsv_ctype=VODS&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=4&amp;Fsv_BtNum=3&amp;Fsv_filetype=0&amp;Fsv_TBt=6000000&amp;Fsv_otype=1&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019" target="_blank" rel="external">http://172.16.199.120:8114/fonsview_hls/00000003000000001234000000000019?stbId=12345678900&amp;userID=U00000013&amp;userToken=&amp;usergroup=&amp;FvSeid=5599584b10b683d0&amp;Fsv_ctype=VODS&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=4&amp;Fsv_BtNum=3&amp;Fsv_filetype=0&amp;Fsv_TBt=6000000&amp;Fsv_otype=1&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019</a></p>
<p>注:<br>这个过程是,盒子请求 cdn的master地址 也就是端口 8112 ,master会根据自己的负载均衡算法,让用户302跳转到 slave节点(端口8114)</p>
<h2 id="9-盒子向ss-slave节点请求-媒体文件"><a href="#9-盒子向ss-slave节点请求-媒体文件" class="headerlink" title="9.盒子向ss slave节点请求 媒体文件"></a>9.盒子向ss slave节点请求 媒体文件</h2><p>盒子请求:<br>GET /fonsview_hls/00000003000000001234000000000019?stbId=12345678900&amp;userID=U00000013&amp;userToken=&amp;usergroup=&amp;FvSeid=5599584b10b683d0&amp;Fsv_ctype=VODS&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=4&amp;Fsv_BtNum=3&amp;Fsv_filetype=0&amp;Fsv_TBt=6000000&amp;Fsv_otype=1&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001<br>Host: 172.16.199.120:8114</p>
<p>SS返回:</p>
<p>#EXTM3U</p>
<p>#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=3000000<br><a href="http://172.16.199.120:8114/VODS/1008_0050000004.m3u8?Fsv_filetype=1&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=50000004&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0&amp;AuthInfo=&amp;version=" target="_blank" rel="external">http://172.16.199.120:8114/VODS/1008_0050000004.m3u8?Fsv_filetype=1&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=50000004&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0&amp;AuthInfo=&amp;version=</a></p>
<p>#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=2000000<br><a href="http://172.16.199.120:8114/VODS/1008_0030000004.m3u8?Fsv_filetype=1&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=30000004&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0&amp;AuthInfo=&amp;version=" target="_blank" rel="external">http://172.16.199.120:8114/VODS/1008_0030000004.m3u8?Fsv_filetype=1&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=30000004&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0&amp;AuthInfo=&amp;version=</a></p>
<p>#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=1000000<br><a href="http://172.16.199.120:8114/VODS/1008_0010000004.m3u8?Fsv_filetype=1&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=10000004&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0&amp;AuthInfo=&amp;version=" target="_blank" rel="external">http://172.16.199.120:8114/VODS/1008_0010000004.m3u8?Fsv_filetype=1&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=10000004&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0&amp;AuthInfo=&amp;version=</a></p>
<p>根据带宽,不同的带宽 3MB,2MB,1MB 访问不同的码率文件</p>
<h2 id="10-盒子请求播放文件"><a href="#10-盒子请求播放文件" class="headerlink" title="10.盒子请求播放文件"></a>10.盒子请求播放文件</h2><p>盒子请求:<br>GET /VODS/1008_0030000004.m3u8?Fsv_filetype=1&amp;Fsv_cid=1008&amp;Fsv_FirstSegID=30000004&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0&amp;AuthInfo=&amp;version= HTTP/1.1<br>Host: 172.16.199.120:8114</p>
<p>SS slave节点返回:</p>
<p>#EXTM3U</p>
<p>#EXT-X-MEDIA-SEQUENCE:0</p>
<p>#EXT-X-VERSION:3</p>
<p>#EXT-X-TARGETDURATION:10</p>
<p>#EXTINF:10.000000,<br><a href="http://172.16.199.120:8114/VODS/1008_140000004_0010000004_0000000000_0002836731.ts?Fsv_Sd=10&amp;Fsv_filetype=2&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;FvOPid=00000003000000001234000000000019&amp;Fsv_MBt=0&amp;FvHlsIdx=3&amp;UserID=&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0" target="_blank" rel="external">http://172.16.199.120:8114/VODS/1008_140000004_0010000004_0000000000_0002836731.ts?Fsv_Sd=10&amp;Fsv_filetype=2&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;FvOPid=00000003000000001234000000000019&amp;Fsv_MBt=0&amp;FvHlsIdx=3&amp;UserID=&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0</a></p>
<p>#EXTINF:10.000000,<br><a href="http://172.16.199.120:8114/VODS/1008_140000004_0010000004_0002836732_0005661055.ts?Fsv_Sd=10&amp;Fsv_filetype=2&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;FvOPid=00000003000000001234000000000019&amp;Fsv_MBt=0&amp;FvHlsIdx=3&amp;UserID=&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0" target="_blank" rel="external">http://172.16.199.120:8114/VODS/1008_140000004_0010000004_0002836732_0005661055.ts?Fsv_Sd=10&amp;Fsv_filetype=2&amp;Provider_id=fonsview_hls&amp;Pcontent_id=00000003000000001234000000000019&amp;FvOPid=00000003000000001234000000000019&amp;Fsv_MBt=0&amp;FvHlsIdx=3&amp;UserID=&amp;Fsv_otype=1&amp;FvSeid=5599584b10b683d0</a></p>
<p>#EXTINF:10.000000,</p>
<p>剩下就是流媒体播放了 …..<br>世界上最优美的音乐, &lt;&lt;千里之外&gt;&gt; 开始播放了  ……..</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/fonsview/演示/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/fonsview/演示/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T13:35:57+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/fonsview/演示/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/fonsview/演示/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>主机信息：<br>172.16.6.43      monkey-4    flueme+kafka+fsvlogstash+stdm<br>172.16.6.42      monkey-5    stsc stsc-reports cas es-master<br>172.16.6.232     monkey-6    es-node</p>
<p>kafka-topics.sh –zookeeper localhost:2181 –list</p>
<p>kafka-console-consumer.sh –zookeeper localhost:2181 –from-beginning –topic cdn-viewlog-hls-stsc</p>
<p>安装时间：4：02.56秒</p>
<p>访问地址：<br><a href="http://172.16.6.42:6600/stat_reports/" target="_blank" rel="external">http://172.16.6.42:6600/stat_reports/</a></p>
<p>es地址：<br><a href="http://172.16.6.42:9200/_plugin/head/" target="_blank" rel="external">http://172.16.6.42:9200/_plugin/head/</a></p>
<p>启动服务：</p>
<p>monekey4<br>cd /opt/fonsview/3RD/flume-1.7.0/bin<br>./flume.sh start</p>
<p>/etc/init.d/kafka start &amp;<br>/etc/init.d/zookeeper start &amp;</p>
<p>cd /opt/fonsview/NE/stsc/stdm/bin<br>sh -x stdm.sh start</p>
<p>/etc/init.d/fsvlogstash start</p>
<p>monkey5<br>/etc/init.d/elasticsearch start</p>
<p>monkey6<br>/etc/init.d/elasticsearch start</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/fonsview/计划任务/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/fonsview/计划任务/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T13:35:57+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/fonsview/计划任务/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/fonsview/计划任务/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>elk </li>
<li><p>epg 监控脚本修改</p>
<ol>
<li>如果有nginx存在 curl 6600</li>
<li>如果没有nginx 存在 curl 6601 </li>
<li>6601的这个端口 读取tomcat配置文件，从tomcat中获取</li>
</ol>
</li>
<li><p>kafana汉化</p>
</li>
<li><p>统计报表 epg在线用户数</p>
</li>
<li><p>写 周一到周三的日报</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/hexo_error/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/hexo_error/" itemprop="url">hexo 报错解决</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T12:12:20+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/hexo_error/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/hexo_error/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Hexo博客Bug："><a href="#Hexo博客Bug：" class="headerlink" title="Hexo博客Bug："></a>Hexo博客Bug：<figure class="highlight plain"><figcaption><span>&#125;&#125;```符号引起的生成报错</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;!-- more --&gt;</div><div class="line">今天使用hexo g 生成博客页面的时候报错了</div><div class="line"></div><div class="line">``` bash</div><div class="line">$ hexo g</div><div class="line">INFO  Start processing</div><div class="line">FATAL Something“s wrong.</div><div class="line">Template render error: (unknown path) [Line 1, Column 155]</div><div class="line">  unexpected token: &#125;&#125;</div><div class="line">at Object.exports.prettifyError (/home/dawx/sync/blog/node_modules/hexo/node_modules/nunjucks/src/lib.js:34:15)</div><div class="line">    at Obj.extend.render (/home/dawx/sync/blog/node_modules/hexo/node_modules/nunjucks/src/environment.js:468:27)</div></pre></td></tr></table></figure></h1><p>作为一个非前端人员，看到一堆js 就懵逼了</p>
<p>Google 之</p>
<p>原来是 我写博客 引用的jinja 代码中 { { } } 符号<br>和hexo有冲突</p>
<p>解决办法:</p>
<p>把代码 使用 ``` 注释起来就好了</p>
<p>推荐： 以后引用的代码最好注释起来</p>
<p>运行 $ hexo server 命令有时会返回这样的错误：</p>
<p>1<br>Error: watch ENOSPC …<br>可以用过运行 $ npm dedupe 来解决，如果不起作用的话，可以尝试在 Linux 终端中运行下列命令：</p>
<p>1<br>$ echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -p<br>这将会提高你能监视的文件数量。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/jenkins/jenkins/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/jenkins/jenkins/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T12:11:30+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/jenkins/jenkins/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/jenkins/jenkins/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>下载<br>docker run -p 8080:8080 -p 50000:50000 jenkins</p>
</li>
<li><p>访问<br><a href="http://127.0.0.1:8080/" target="_blank" rel="external">http://127.0.0.1:8080/</a></p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">jenkins version</div><div class="line">Jenkins 2.46.1</div><div class="line"></div><div class="line">Jenkins initial setup is required. An admin user has been created and a password generated.</div><div class="line">Please use the following password to proceed to installation</div><div class="line"></div><div class="line">0016cae29829465c99a4f90dc727a520</div><div class="line"></div><div class="line">This may also be found at /var/jenkins_home/secrets/initialAdminPassword</div></pre></td></tr></table></figure>
<ol>
<li>在插件管理中添加仓库<br>清华大学镜像仓库：<br><a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json" target="_blank" rel="external">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a></li>
</ol>
<p>仓库添加好之后 还要重新获取update</p>
<ol>
<li>安装pipeline模块</li>
</ol>
<p>构建步骤<br>scm    build    existence    regression    report    deploy</p>
<p>—–jenkins 目录结构<br>root ➜  ~ rpm -ql jenkins<br>/etc/init.d/jenkins<br>/etc/logrotate.d/jenkins<br>/etc/sysconfig/jenkins<br>/usr/lib/jenkins<br>/usr/lib/jenkins/jenkins.war<br>/usr/sbin/rcjenkins<br>/var/cache/jenkins<br>/var/lib/jenkins<br>/var/log/jenkins</p>
<p>—-docker 团队<br><a href="https://jenkins.dockerproject.org/" target="_blank" rel="external">https://jenkins.dockerproject.org/</a></p>
<p>问题：<br>1.<br>groovy的脚本 可以在http://<jenkins>:8080/script 执行</jenkins></p>
<p>写到pipeline中，调用系统有些库，会报错 不允许。</p>
<p>原因：在pipeline中,为了安全性groovy默认是在一个sandbox环境中运行的</p>
<p>解决办法：</p>
<ol>
<li><p>Jenkins -&gt; 系统管理 -&gt; In-process Script Approval 当在sanbox环境中被拒绝调用的api会显示在这里，点击Approval 允许即可  （ps：这里很反人类，允许只能一个个的允许，点一堆很痛苦）</p>
</li>
<li><p>在新建的pipeline任务中，下面有个默认勾选的选项，去除勾选，让任务不在sandbox中允许即可。</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">引入外部sdk</div><div class="line"></div><div class="line">1. Go to Jenkins &gt; Manage Jenkins &gt; Configure System</div><div class="line">2. Check &quot;Environment variables&quot;</div><div class="line">3. add name： ANDROID_HOME, value -&gt; your android sdk dir</div><div class="line">4. click &quot;add&quot;</div><div class="line">5. SCROLL DOWN CLICK SAVE</div></pre></td></tr></table></figure>
<p>—–远程执行脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">(fonsview_deploy) monkey ➜  groovy cat run.sh </div><div class="line">script_path=$1</div><div class="line">echo $script_path</div><div class="line">mytoken=$(curl --user &apos;monkey:123.coM&apos; -s http://127.0.0.1:8080/crumbIssuer/api/json | python -c &apos;import sys,json;j=json.load(sys.stdin);print j[&quot;crumbRequestField&quot;] + &quot;=&quot; + j[&quot;crumb&quot;]&apos;)</div><div class="line">curl --user &apos;monkey:123.coM&apos; -d &quot;$mytoken&quot; --data-urlencode &quot;script=$(&lt;$script_path)&quot; http://127.0.0.1:8080/scriptText</div><div class="line">---</div><div class="line">run.sh 1.groovy</div><div class="line"></div><div class="line">http://myserver/jenkins/scriptler/run/&lt;yourScriptId&gt;?param1=value1</div></pre></td></tr></table></figure>
<h2 id="jenksins-启用ssh-server"><a href="#jenksins-启用ssh-server" class="headerlink" title="jenksins 启用ssh server"></a>jenksins 启用ssh server</h2><p>install sshd 模块<br>jenkins -&gt; 系统管理 -&gt; 系统设置 –&gt; SSH Server –&gt; SSHD Port    –&gt; 随机一个port</p>
<h2 id="启动docker镜像端口"><a href="#启动docker镜像端口" class="headerlink" title="启动docker镜像端口"></a>启动docker镜像端口</h2><p>安装Docker plugin 模块<br> tcp://172.16.42.43:4243 or unix:///var/run/docker.sock</p>
<p>CloudBees Docker Build and Publish1.3.2  利用dockerfile 构建系统</p>
<p>好网站教你怎么打包镜像<br><a href="https://www.katacoda.com/" target="_blank" rel="external">https://www.katacoda.com/</a></p>
<p><a href="https://go.cloudbees.com/docs/cloudbees-documentation/cje-user-guide/index.html#docker-workflow" target="_blank" rel="external">https://go.cloudbees.com/docs/cloudbees-documentation/cje-user-guide/index.html#docker-workflow</a></p>
<p><a href="https://my.oschina.net/donhui/blog/481230" target="_blank" rel="external">https://my.oschina.net/donhui/blog/481230</a></p>
<h2 id="自动清除工作空间"><a href="#自动清除工作空间" class="headerlink" title="自动清除工作空间"></a>自动清除工作空间</h2><pre><code>deleteDir()
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/ELK/elastalert/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/ELK/elastalert/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T11:42:41+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/ELK/elastalert/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/ELK/elastalert/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="python-m-elastalert-elastalert-–config-config-yaml"><a href="#python-m-elastalert-elastalert-–config-config-yaml" class="headerlink" title="python -m elastalert.elastalert –config ./config.yaml"></a>python -m elastalert.elastalert –config ./config.yaml</h1><p><a href="http://kibana.logstash.es/content/elasticsearch/other/elastalert.html" target="_blank" rel="external">参考</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.rhel.cc/2017/05/23/ELK/es_查询总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kikiyou">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Monkey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/ELK/es_查询总结/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T11:41:25+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/ELK/es_查询总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/ELK/es_查询总结/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>只返回指定的字段<h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><ol>
<li>使用 _source<br>GET /logstash-v5-equipment-2016.11.03/v5-equipment/_search<br>{<br>“_source”: {<br>“include”: [“uid”]<br>},<br>“query”:{<br>“filtered”:{<br> “filter”:{<br>   “match”:{“code”:”ZhiZunBaoXiang”}<br> }<br>}<br>}<br>}</li>
</ol>
</li>
</ul>
<ol>
<li>使用fields 字段<br>GET /logstash-v5-equipment-2016.11.03/v5-equipment/_search<br>{<br>“fields”: [“uid”],<br>“query”:{<br>“filtered”:{<br>  “filter”:{<pre><code>&quot;match&quot;:{&quot;code&quot;:&quot;ZhiZunBaoXiang&quot;}
</code></pre>  }<br>}<br>}<br>}</li>
</ol>
<p>Elasticsearch Query DSL、Facets、Aggs学习困惑。</p>
<p>有人为此开发了使用SQL执行ES Query的插件，一定程度上减轻了进入门槛。我们给出的学习他们的建议是观察Kibana的Request Body或试用Marvel的Senese插件，它有自动完成Query、Facets、Aggs的功能。另外最常用的query是query string query，最常用的aggs是Terms、Date Histogram，可以应付大部分需求。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://7xw819.com1.z0.glb.clouddn.com/RH_CertifiedArchitect_RGB.svg"
               alt="kikiyou" />
          <p class="site-author-name" itemprop="name">kikiyou</p>
           
              <p class="site-description motion-element" itemprop="description">越努力越幸运</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">204</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yewang15215" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.quora.com/profile/King-Yip-3" target="_blank" title="Quora">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Quora
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/wutongyip" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.douban.com/people/yewang15215/" target="_blank" title="豆瓣">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.guokr.com/i/0121652172/" target="_blank" title="果壳">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  果壳
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/hellokingyip" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Facebook
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/KingYip15215" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/kingyip15215" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  新浪微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/sindresorhus/awesome" title="Awesome" target="_blank">Awesome</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kikiyou</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"liveandlearn"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  
















  





  

  

  

  

  

</body>
</html>
